---
layout: post
title: Week 14, Patches and Open Source and...
---

# Patches at last

I finally was able to complete some patches to send to the upstream linux kernel team, which has been an incredibly fulfilling experience at last. I was unable to find an avenue to contribute until now because other parts of the kernel either had too steep of a learning curve for me to be able to understand in time for me to contribute, or were too robust and well written for me to be able to find anything that I could productively add to it. However, this past week I finally managed to narrow in on a contribution that I could make and I ended up submitting a patch upstream to the kernel which was honestly a very stressful experience but was very rewarding as well!

<!--more-->

The contribution that I made was to the hp-wmi drivers for my laptop. The drivers handled the keyboard input for hp keyboards. The drivers use something called WMI, or windows management instrumentation, which as you might guess is not really built for linux support, and is made specifically in order to interface with manufacturer created windows drivers. The implementation of these drivers is often fairly opaque to linux and involves some reverse engineering to figure out. The specifics of my contribution involved the fn+escape keycode, the fn+f8 keycode, the microphone mute keycode, the fn+f12 programmable keycode and the button that opens and closes the camera shutter.

The regular keys were relatively straightforward to implement and my patch regarding those didn't receive that much comment upstream. The camera shutter button was a lot more difficult though. The upstream developers, one who worked for AMD, and one who worked for redhat, eventually reached the conclusion that the proper way to handle this button was to send an event that the camera shutter switch was turned on or off. However, because these switches can be queried even when the shutter is not open or closed, they told me that I needed to create a new input device on the first time the camera shutter was opened or closed in order to avoid having to report a state before we can know a state to be certain, that is when the camera shutter button is pressed and a code for opened or closed is sent to the operating system.

The process of sending the patches upstream was quite difficult as well, involving sending email from the command line and many tests which required full reboots of the operating system.

The links to the LKML threads on the lore.kernel.org mirror are regarding my patch is: [patch 1 v1](https://lore.kernel.org/platform-driver-x86/MN0PR12MB6101D9688E7904FF52634520E2649@MN0PR12MB6101.namprd12.prod.outlook.com/T/), [patch 2 v1](https://lore.kernel.org/platform-driver-x86/20230425202219.7511-1-jes965@nyu.edu/T/), [patchset (1 and 2) v2](https://lore.kernel.org/platform-driver-x86/20230426164936.8807-1-jes965@nyu.edu/T/), [patchset (1 and 2) v3](https://lore.kernel.org/platform-driver-x86/MN0PR12MB6101510EDF6D0904E602A3F9E2659@MN0PR12MB6101.namprd12.prod.outlook.com/T/).

# Open source and...

Learning about all the different applications of open source towards endeavors other than software was very interesting. I personally talked about the way that open source has been important in making Jewish texts more accessible to a broader population. When previously in order to read texts of Jewish scholarship such as Tosefot you often had to buy the many volume copies of the texts which could cost hundreds of dollars, or you had to find a jewish text study library (called a beit midrash) which had a copy. Making all of these texts, which if one were to try to own all of them would cost tens of thousands of dollars, available for free under permissive licenses online, and to have this corpus of texts available for modification by a pull request to the service, Sefaria's website, has really revolutionized Jewish text study.
In addition, learning about the other applications for open source, whether they are like Sefaria educational resources, or whether they're different was very interesting too! The Open Seeds Initiative was really interesting, as I know companies like Monsanto have made farmer's ownership of their own crops more of a fiction than a reality. Open source could absolutely be a way to put power back in the hands of the people who actually farm rather than in corporations which make farmers dependent on them.
Whether it's more casual things like open source recipes (whether for cola or food) or open source in politics, or utilitarian things like open source office suites, or more culturally meaningful things like open source hair, the open source and... projects that we discussed were all excellent case studies in the breadth that permissive licensing and open ability to modify can give endeavors in many realms of human experience, not only software.
